<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>05 Functions &amp; Scopes | JavaScript Fundamentals</title>

    <link rel="icon" href="../img/zuehlke_logo.jpg">
    <link rel="stylesheet" href="../css/reveal.css">
    <link rel="stylesheet" href="../css/theme/zuehlke.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="../lib/css/atom-one-dark.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? '../css/print/pdf.css' : '../css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section class="deck-slide">
            <h1>JavaScript Fundamentals<br>05 Functions and Scopes</h1>
        </section>
        <section>
            <section>
                <h2>Functions( ) { }</h2>
                <p>Function Declaration</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    sum(4, 9); // 13

                    function sum(a, b) {
                        return a + b;
                    }

                    sum(4, 9); // 13
                </code>
                </pre>
            </section>
            <section>
                <h2>Functions ( ) { } </h2>
                <p>Function Expression</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    sum(1, 3); // TypeError: undefined is not a function

                    const sum = function(a, b) {
                        return a + b;
                    }

                    sum(1, 3); // 4
                </code>
                </pre>
                <div class="tip fragment">don't worry, we will cover the difference in more detail later</div>
            </section>
            <section>
                <h2>Functions ( ) {Â }</h2>
                <p>(fat) arrow functions</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    const fatArrow = () => console.log('arrow function');
                    // is the same as
                    const fatArrow = function() {
                        console.log('arrow function')
                    }
                </code>
                </pre>
                <div class="tip fragment">Actually, it is not 100% the same, but we will cover that later.</div>
            </section>
            <section>
                <h2>Functions ( ) { } </h2>
                <p>Functions are first-class objects</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    function doThis(fn) {
                        fn();
                    }

                    function giveMeAFunction() {
                        return () => console.log('I am a function');
                    }
                </code>
                </pre>
            </section>
        </section>
        <section>
            <section>
                <h2>Rest Parameters</h2>
                <p>turns n parameters into an array</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    function sum(...theArgs) {
                      return theArgs.reduce((previous, current) => {
                        return previous + current;
                      });
                    }

                    console.log(sum(1, 2, 3)); // 6
                    console.log(sum(1, 2, 3, 4)); // 10
                </code>
                </pre>
            </section>
            <section>
                <h2>Spread Syntax</h2>
                <p>Expands arrays or objects</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    function sum(x, y, z) {
                        return x + y + z;
                    }

                    const numbers = [1, 2, 3];

                    console.log(sum(...numbers)); // 6
                </code>
                </pre>
            </section>
            <section>
                <h2>Spread Syntax</h2>
                <p>Expands arrays or objects</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    var dateFields = [1970, 0, 1];  // 1 Jan 1970
                    var d = new Date(...dateFields);
                </code>
                </pre>
            </section>
            <section>
                <h2>Rest & Spread</h2>
                <p>What happens here?</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    function printValues(...values) {
                        console.log(values.length);
                    }

                    const values = ['a', 'b', 'c'];

                    printValues(values); // ?
                    printValues(...values); // ?
                </code>
                </pre>
            </section>
        </section>
        <section>
            <section>
                <h2>Scope</h2>
                <p>JavaScript has a <span class="warn">Global Scope</span> and <span
                        class="warn">Function/Local Scope</span></p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    let globalVariable = 'I am global!';

                    function createScope() {
                        let localVariable = 'I am function-scoped!';
                    }

                    console.log(globalVariable); // I am global
                    console.log(localVariable);  // ReferenceError
                </code>
                </pre>
            </section>
            <section>
                <h2>Scope</h2>
                <p>There is no block scope...</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    if (isOver18) {
                        var canHaveDrinks = true;
                    }

                    console.log(canHaveDrinks); // true
                </code>
                </pre>
            </section>
            <section>
                <h2>Scope</h2>
                <p>... unless you use <span class="code">let</span> or <span class="code">const</span>!</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    if (isOver18) {
                        let canHaveDrinks = true;
                    }

                    console.log(canHaveDrinks); // ReferenceError
                </code>
                </pre>
            </section>
            <section>
                <h2>Scope</h2>
                <p>This makes <span class="code">for-loops</span> a little less annoying.</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    for (var i = 0; i < arr.length; i++) {
                        // i is visible in the whole function scope :(
                    }
                    <span class="fragment">
                    for (let k = 0; k < arr.length; k++) {
                        // k is only visible here :)
                    }
                        </span>
                </code>
                </pre>
                <div class="tip fragment">In your daily life, always use const or let</div>
            </section>
            <section>
                <h2>Scope</h2>
                <p>IIFE: Immediately Invoked Function Expression</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    (() => {
                        const name = 'I am not on the global scope';
                    })()

                    console.log(name); // ReferenceError
                </code>
                </pre>
            </section>
            <section>
                <h2>Scope</h2>
                <p>IIFEs are commonly used to prevent polluting the global scope and creating a "public API"</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    ((global) => {
                        function render() { ... }
                        function helperMethod() { ... }

                        global.MyLibrary = {
                            render: render
                        }
                    })(window)

                    window.MyLibrary.render();
                    window.MyLibrary.helperMethod(); // ReferenceError
                </code>
                </pre>
            </section>
            <section>
                <h2>Try it yourself</h2>
                <p data-height="412" data-theme-id="0" data-slug-hash="gegNqO" data-default-tab="js,result"
                   data-user="enpayne" data-embed-version="2" data-pen-title="IIFE Modules" data-editable="true"
                   class="codepen">See the Pen <a href="https://codepen.io/enpayne/pen/gegNqO/">IIFE Modules</a> by Nick
                    Payne (<a href="https://codepen.io/enpayne">@enpayne</a>) on <a
                            href="https://codepen.io">CodePen</a>.</p>
                <script async src="https://static.codepen.io/assets/embed/ei.js"></script>
            </section>
        </section>
        <section>
            <section>
                <h2>Hoisting</h2>
                <p>This term is an attempt to make the way JavaScript compiles and runs code more understandable.</p>

                <p>Simply put, <span class="warn">declarations</span>
                    are put into memory during the compile phase, before any code is executed.</p>
                <p class="fragment"><span class="warn">....what?</span></p>
            </section>
            <section>
                <h2>Hoisting</h2>
                <p>Consider this...</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    printStuff();

                    function printStuff() {
                        console.log('stuff');
                    }
                </code>
                </pre>
                <p class="fragment">Why does this work? The declared function
                    <span class="code">printStuff</span> seems to be available "further up" than where it was authored.
                </p>
            </section>
            <section>
                <h2>Hoisting</h2>
                <p>This is where the concept of <span class="warn">hoisting</span> comes in. We think of declarations
                    being
                    <span class="warn">moved to the top</span> of their function scope. It also applies to <span
                            class="code">var</span> declarations.</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    x = 5;
                    x = x * 2;
                    var x;
                    console.log(x); // 10
                </code>
                </pre>
            </section>
            <section>
                <h2>Hoisting</h2>
                <p>Now you know the difference between the two ways of creating a function... right?</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    sum(1, 3);
                    add(2, 4);

                    var sum = function(a, b) {
                        return a + b;
                    }

                    function add(a, b) {
                        return a + b;
                    }
                </code>
                </pre>
            </section>
            <section>
                <h2>Hoisting</h2>
                <p><span class="code">let</span> and <span class="code">const</span> work in a slightly different way.
                </p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    x = 5;
                    x = x * 2;
                    let x;
                    console.log(x); // ReferenceError
                </code>
                </pre>
            </section>
            <section>
                <h2>Hoisting</h2>
                <p>Even though they are still hoisted, they can't be accessed before they are declared in the code.</p>
                <p>This is called the <span class="warn">Temporal Deadzone (TDZ)</span>.</p>
                <p>We won't cover this in more detail since it shouldn't affect you too much.</p>
            </section>
            <section>
                <h2>Exam I</h2>
                <p><span class="code">undefined</span> or <span class="code">hello?</span></p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                   function hoist(a) {
                        hoisted = a;
                        console.log(a);
                        var hoisted;
                    }

                    hoist('hello?');
                </code>
                </pre>
            </section>
            <section>
                <h2>Exam I</h2>
                <p><span class="code strikethrough">undefined</span> or <span class="code">hello?</span></p>
                <div class="comparison">
                    <div class="code">
                        <pre>
                            <code class="hljs javascript" data-trim contenteditable data-noescape>
                               function hoist(a) {
                                    hoisted = a;
                                    console.log(a);
                                    var hoisted;
                                }

                                hoist('hello?');
                            </code>
                </pre>
                    </div>
                    <div class="code">
                        <pre>
                            <code class="hljs javascript" data-trim contenteditable data-noescape>
                               function hoist(a) {
                                    var hoisted;
                                    hoisted = a;
                                    console.log(a);
                                }

                                hoist('hello?');
                            </code>
                        </pre>
                    </div>
                </div>
            </section>
            <section>
                <h2>Exam II</h2>
                <p><span class="code">undefined</span> or <span class="code">Henry</span>?</p>
                <pre>
                <code class="hljs javascript" data-trim contenteditable data-noescape>
                    printName('Henry');

                    function printName(name) {
                        console.log(b);
                        var b = name;
                    }
                </code>
                </pre>
            </section>
            <section>
                <h2>Exam II</h2>
                <p><span class="code">undefined</span> or <span class="code strikethrough">Henry</span>?</p>
                <div class="comparison">
                    <div class="code">
                        <pre>
                            <code class="hljs javascript" data-trim contenteditable data-noescape>
                                printName('Henry');

                                function printName(name) {
                                    console.log(b);
                                    var b = name;

                                }

                            </code>
                </pre>
                    </div>
                    <div class="code">
                        <pre>
                            <code class="hljs javascript" data-trim contenteditable data-noescape>
                                printName('Henry');

                                function printName(name) {
                                    var b;
                                    console.log(b);
                                    b = name;
                                }
                            </code>
                        </pre>
                    </div>
                </div>

            </section>
        </section>
        <section>
            <section>
                <h2>Closures</h2>
                <p>Closure is when a function is able to remember and access its lexical scope even when that function
                    is executing outside its lexical scope.</p>
            </section>
            <section>
                <h2>Closures</h2>
                <p>Lexical scope is what most of us are used to. It is also known as static scope.</p>
                <pre>
                    <code class="hljs javascript" data-trim contenteditable data-noescape>
                        function closey() {
                            let x = 2;

                            talk();

                            function talk() {
                                console.log(x);
                            }
                        }

                        closey(); // 2
                    </code>
                </pre>
            </section>
            <section>
                <h2>Closures</h2>
                <p>Closure lets functions access the scope they were declared in from outside that scope.</p>
                <pre>
                    <code class="hljs javascript" data-trim contenteditable data-noescape>
                        function closey() {
                            let x = 2;

                            function talk() {
                                console.log(x);
                            }

                            return talk;
                        }

                        const talk = closey();
                        talk(); // 2
                    </code>
                </pre>
            </section>
            <section>
                <h2>Closures</h2>
                <p>This sounds very fancy, but you probably already use this in your code.</p>
                <pre>
                    <code class="hljs javascript" data-trim contenteditable data-noescape>
                        function wait(message) {
                            setTimeout(function() {
                                console.log(message);
                            }, 1000)
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h2>Closures</h2>
                <p>What do you think happens here?</p>
                <pre>
                    <code class="hljs javascript" data-trim contenteditable data-noescape>
                        for (var i = 1; i <= 5; i++) {
                            setTimeout(() => console.log(i), i * 1000);
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h2>Closures</h2>
                <p>A slightly tweaked version</p>
                <pre>
                    <code class="hljs javascript" data-trim contenteditable data-noescape>
                        for (var i = 1; i <= 5; i++) {
                            function wait(k) {
                                setTimeout(function timer() {
                                    console.log(k);
                                }, i*1000 );
                            }

                            wait(i);
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h2>Closures</h2>
                <p><span class="warn">Careful!</span></p>
                <p>References in closures can lead to memory leaks, for example when registering events.</p>
                <pre>
                    <code class="hljs javascript" data-trim contenteditable data-noescape>
                        const aBigObject = {};

                        button.onClick = function() {
                            console.log(aBigObject.lotsOfData)
                        }
                    </code>
                </pre>
                <div class="tip fragment">Keep your events tidy !</div>
            </section>
        </section>
        <section class="deck-slide">
            <h1>Questions?</h1>
        </section>
    </div>
</div>
<script src="../lib/js/head.min.js"></script>
<script src="../js/reveal.js"></script>

<script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            { src: '../plugin/markdown/marked.js' },
            { src: '../plugin/markdown/markdown.js' },
            { src: '../plugin/notes/notes.js', async: true },
            {
                src: '../plugin/highlight/highlight.js', async: true, callback: function () {
                    hljs.initHighlightingOnLoad();
                }
            }
        ]
    });
</script>
</body>
</html>
